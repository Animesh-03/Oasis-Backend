version: "3"
services:
# Backend Server
  server:
    container_name: "oasis_backend_server"
    build:
      dockerfile: Dockerfile.dev
      context: .
    volumes:
      - ./src:/oasis/src
    environment:
      - NODE_ENV=dev
      - PORT=8080
    ports:
      - '8080:8080'
    networks:
      - oasis_network
# Mongodb Server
  db:
    image: mongo
    container_name: "oasis_db"
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - db_store:/data/db
    ports:
      - 27018:27017
    logging:
      driver: "none"
    networks:
      - oasis_network
# Redis Server
  redis:
    image: redis
    container_name: oasis_redis
    volumes:
      - ./src/config/redis:/etc/redis
      - redis_dump:/data/
    logging:
      driver: "none"
    command: ['redis-server', '/etc/redis/redis.conf', '--bind', 'redis', '--port', '6379']
    networks:
      - oasis_network
volumes:
  db_store:
  redis_dump:
networks:
  oasis_network:
    name: oasis_backend_network
    driver: bridge
